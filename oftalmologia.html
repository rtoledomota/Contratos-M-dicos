<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Oftalmologia - Comparativo</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); padding: 20px; min-height: 100vh; }
        .container { max-width: 1400px; margin: 0 auto; }
        .header { background: white; padding: 30px; border-radius: 10px; margin-bottom: 20px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
        .header h1 { color: #0066cc; font-size: 28px; margin-bottom: 10px; }
        .header p { color: #666; font-size: 14px; }
        
        .mes-selector { display: flex; gap: 10px; margin-bottom: 20px; flex-wrap: wrap; }
        .mes-btn { padding: 10px 15px; background: white; border: 2px solid #ddd; border-radius: 5px; cursor: pointer; transition: all 0.3s; }
        .mes-btn.active { background: #0066cc; color: white; border-color: #0066cc; }
        .mes-btn:hover { border-color: #0066cc; }
        
        .mes-container { background: white; border-radius: 10px; padding: 30px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); margin-bottom: 20px; }
        .mes-titulo { color: #0066cc; font-size: 24px; margin-bottom: 20px; font-weight: 600; }
        
        .resumo-geral { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px; margin-bottom: 30px; }
        .card-resumo { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 20px; border-radius: 8px; }
        .card-label { font-size: 12px; opacity: 0.9; }
        .card-valor { font-size: 24px; font-weight: 700; margin-top: 10px; }
        
        .servicos-table, .cirurgias-table { margin-bottom: 30px; }
        .table-titulo { color: #0066cc; font-size: 18px; font-weight: 600; margin-bottom: 15px; }
        table { width: 100%; border-collapse: collapse; }
        th { background: #f0f0f0; padding: 12px; text-align: left; border-bottom: 2px solid #ddd; font-weight: 600; color: #333; }
        td { padding: 12px; border-bottom: 1px solid #eee; }
        tr:hover { background: #f9f9f9; }
        .numero { text-align: right; font-weight: 600; }
        .barra-progresso { display: flex; align-items: center; gap: 10px; }
        .barra { flex: 1; height: 8px; background: #eee; border-radius: 4px; overflow: hidden; }
        .barra-preenchida { height: 100%; background: linear-gradient(90deg, #667eea 0%, #764ba2 100%); border-radius: 4px; }
        .percentual { font-size: 12px; font-weight: 600; color: #666; }
        
        .grafico-container { display: grid; grid-template-columns: repeat(auto-fit, minmax(400px, 1fr)); gap: 20px; margin-top: 30px; }
        .grafico { background: white; padding: 20px; border-radius: 8px; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üëÅÔ∏è OFTALMOLOGIA - AN√ÅLISE DE CONSUMO</h1>
            <p>Comparativo entre valor contratado e valor gasto por servi√ßo</p>
        </div>
        
        <div class="mes-selector" id="mesSeletor"></div>
        
        <div id="conteudoMes"></div>
    </div>

    <script>
        const precos = {
            "Consultas": 64.00,
            "Biometria": 48.48,
            "Campo visual": 80.00,
            "Retinografia Colorida": 49.36,
            "Microscopia especular de cornea": 48.48,
            "Topografia": 48.48,
            "Paquimetria Ultrassonica": 29.62,
            "Angiografia": 128.00,
            "Tomografia de": 96.00,
            "Procedimento 10": 48.40,
            "Procedimento 11": 771.60,
            "Procedimento 13": 1500.00,
            "Procedimento 14": 449.44,
            "Procedimento 15": 898.35,
            "Procedimento 16": 112.77,
            "Procedimento 17": 45.00,
            "Procedimento 18": 4701.84,
            "Procedimento 19": 107.61,
            "Procedimento 20": 627.28,
            "Procedimento 21": 1661.76
        };

        const contratos = {
            "Consultas": 4000,
            "Biometria": 100,
            "Campo visual": 220,
            "Retinografia Colorida": 200,
            "Microscopia especular de cornea": 120,
            "Topografia": 150,
            "Paquimetria Ultrassonica": 100,
            "Angiografia": 40,
            "Tomografia de": 300,
            "Procedimento 10": 40,
            "Procedimento 11": 100,
            "Procedimento 13": 2,
            "Procedimento 14": 30,
            "Procedimento 15": 1,
            "Procedimento 16": 70,
            "Procedimento 17": 40,
            "Procedimento 18": 5,
            "Procedimento 19": 40,
            "Procedimento 20": 60,
            "Procedimento 21": 2
        };

        const dados = {
            JAN: { nome: "Janeiro", contratado: "R$ 152.688,00", consumido: "R$ 635.618,49", saldo: "R$ 32.401,98", procs: [["Consultas", 3785], ["Biometria", 51], ["Campo visual", 93], ["Retinografia Colorida", 73], ["Microscopia especular de cornea", 57], ["Topografia", 128], ["Paquimetria Ultrassonica", 42], ["Angiografia", 12], ["Tomografia de", 280], ["Procedimento 10", 50], ["Procedimento 11", 108], ["Procedimento 13", 92], ["Procedimento 15", 29], ["Procedimento 16", 24], ["Procedimento 17", 3], ["Procedimento 18", 38], ["Procedimento 19", 56], ["Procedimento 21", 18]] },
            FEV: { nome: "Fevereiro", contratado: "R$ 152.688,00", consumido: "R$ 736.911,11", saldo: "-R$ 68.890,64", procs: [["Consultas", 4862], ["Biometria", 69], ["Campo visual", 204], ["Retinografia Colorida", 109], ["Microscopia especular de cornea", 76], ["Topografia", 146], ["Paquimetria Ultrassonica", 55], ["Angiografia", 12], ["Tomografia de", 355], ["Procedimento 10", 49], ["Procedimento 11", 110], ["Procedimento 13", 70], ["Procedimento 15", 37], ["Procedimento 16", 34], ["Procedimento 17", 6], ["Procedimento 18", 48], ["Procedimento 19", 62], ["Procedimento 20", 2]] },
            MAR: { nome: "Mar√ßo", contratado: "R$ 152.688,00", consumido: "R$ 683.430,90", saldo: "-R$ 15.410,43", procs: [["Consultas", 4464], ["Biometria", 81], ["Campo visual", 167], ["Microscopia especular de cornea", 83], ["Topografia", 154], ["Paquimetria Ultrassonica", 79], ["Tomografia de", 263], ["Procedimento 10", 30], ["Procedimento 11", 107], ["Procedimento 13", 60], ["Procedimento 15", 34], ["Procedimento 16", 44], ["Procedimento 17", 5], ["Procedimento 18", 57], ["Procedimento 19", 61], ["Procedimento 21", 19]] },
            ABR: { nome: "Abril", contratado: "R$ 152.688,00", consumido: "R$ 670.374,01", saldo: "-R$ 2.353,54", procs: [["Consultas", 3943], ["Biometria", 79], ["Campo visual", 114], ["Retinografia Colorida", 99], ["Microscopia especular de cornea", 87], ["Topografia", 151], ["Paquimetria Ultrassonica", 50], ["Angiografia", 17], ["Tomografia de", 311], ["Procedimento 10", 44], ["Procedimento 11", 98], ["Procedimento 13", 89], ["Procedimento 15", 42], ["Procedimento 16", 40], ["Procedimento 17", 6], ["Procedimento 18", 72], ["Procedimento 19", 59], ["Procedimento 20", 3], ["Procedimento 21", 1]] },
            MAI: { nome: "Maio", contratado: "R$ 152.688,00", consumido: "R$ 673.404,23", saldo: "-R$ 5.383,76", procs: [["Consultas", 4201], ["Biometria", 104], ["Campo visual", 117], ["Retinografia Colorida", 116], ["Microscopia especular de cornea", 98], ["Topografia", 176], ["Paquimetria Ultrassonica", 70], ["Angiografia", 6], ["Tomografia de", 344], ["Procedimento 10", 42], ["Procedimento 11", 100], ["Procedimento 13", 60], ["Procedimento 14", 1], ["Procedimento 15", 35], ["Procedimento 16", 78], ["Procedimento 17", 4], ["Procedimento 18", 38], ["Procedimento 19", 61], ["Procedimento 20", 1], ["Procedimento 21", 25]] },
            JUN: { nome: "Junho", contratado: "R$ 152.688,00", consumido: "R$ 634.565,75", saldo: "R$ 33.454,72", procs: [["Consultas", 3578], ["Biometria", 78], ["Campo visual", 119], ["Retinografia Colorida", 76], ["Microscopia especular de cornea", 84], ["Topografia", 132], ["Paquimetria Ultrassonica", 20], ["Angiografia", 6], ["Tomografia de", 319], ["Procedimento 10", 36], ["Procedimento 11", 95], ["Procedimento 13", 74], ["Procedimento 15", 58], ["Procedimento 16", 75], ["Procedimento 17", 5], ["Procedimento 18", 39], ["Procedimento 19", 63], ["Procedimento 20", 2], ["Procedimento 21", 22]] },
            JUL: { nome: "Julho", contratado: "R$ 152.688,00", consumido: "R$ 655.108,07", saldo: "R$ 12.912,40", procs: [["Consultas", 4177], ["Biometria", 50], ["Campo visual", 145], ["Retinografia Colorida", 80], ["Microscopia especular de cornea", 68], ["Topografia", 128], ["Paquimetria Ultrassonica", 47], ["Angiografia", 7], ["Tomografia de", 220], ["Procedimento 10", 39], ["Procedimento 11", 108], ["Procedimento 13", 30], ["Procedimento 14", 2], ["Procedimento 15", 64], ["Procedimento 16", 64], ["Procedimento 17", 6], ["Procedimento 18", 43], ["Procedimento 19", 65]] },
            AGO: { nome: "Agosto", contratado: "R$ 152.688,00", consumido: "R$ 647.693,47", saldo: "R$ 20.327,00", procs: [["Consultas", 4124], ["Biometria", 64], ["Campo visual", 163], ["Retinografia Colorida", 51], ["Microscopia especular de cornea", 81], ["Topografia", 100], ["Paquimetria Ultrassonica", 20], ["Angiografia", 5], ["Tomografia de", 267], ["Procedimento 10", 53], ["Procedimento 11", 91], ["Procedimento 13", 14], ["Procedimento 14", 1], ["Procedimento 15", 67], ["Procedimento 16", 37], ["Procedimento 17", 8], ["Procedimento 18", 39], ["Procedimento 19", 59], ["Procedimento 20", 3], ["Procedimento 21", 18]] },
            SET: { nome: "Setembro", contratado: "R$ 152.688,00", consumido: "R$ 637.993,32", saldo: "R$ 30.027,15", procs: [["Consultas", 3938], ["Biometria", 91], ["Campo visual", 177], ["Retinografia Colorida", 77], ["Microscopia especular de cornea", 95], ["Topografia", 139], ["Paquimetria Ultrassonica", 20], ["Angiografia", 10], ["Tomografia de", 359], ["Procedimento 10", 34], ["Procedimento 11", 92], ["Procedimento 13", 27], ["Procedimento 15", 70], ["Procedimento 16", 48], ["Procedimento 17", 5], ["Procedimento 18", 54], ["Procedimento 19", 57], ["Procedimento 20", 2]] },
            OUT: { nome: "Outubro", contratado: "R$ 152.688,00", consumido: "R$ 657.065,89", saldo: "R$ 10.954,58", procs: [["Consultas", 4010], ["Biometria", 75], ["Campo visual", 178], ["Retinografia Colorida", 56], ["Microscopia especular de cornea", 88], ["Topografia", 135], ["Paquimetria Ultrassonica", 39], ["Angiografia", 7], ["Tomografia de", 292], ["Procedimento 10", 49], ["Procedimento 11", 103], ["Procedimento 13", 26], ["Procedimento 15", 74], ["Procedimento 16", 46], ["Procedimento 17", 7], ["Procedimento 18", 37], ["Procedimento 19", 59], ["Procedimento 20", 2], ["Procedimento 21", 24]] },
            NOV: { nome: "Novembro", contratado: "R$ 152.688,00", consumido: "R$ 0,00", saldo: "R$ 0,00", procs: [] },
            DEZ: { nome: "Dezembro", contratado: "R$ 152.688,00", consumido: "R$ 0,00", saldo: "R$ 0,00", procs: [] }
        };

        function formatarMoeda(valor) {
            return new Intl.NumberFormat('pt-BR', { style: 'currency', currency: 'BRL' }).format(valor);
        }

        function calcularValorGasto(procs) {
            let total = 0;
            for (const [proc, qtd] of procs) {
                const preco = precos[proc] || 0;
                total += preco * qtd;
            }
            return total;
        }

        function renderizarMesSeletor() {
            const html = Object.keys(dados).map(mes => 
                `<button class="mes-btn ${mes === 'JAN' ? 'active' : ''}" onclick="selecionarMes('${mes}')">${dados[mes].nome}</button>`
            ).join('');
            document.getElementById('mesSeletor').innerHTML = html;
        }

        function selecionarMes(mes) {
            document.querySelectorAll('.mes-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            renderizarMes(mes);
        }

        function renderizarMes(mes) {
            const d = dados[mes];
            const valorGasto = calcularValorGasto(d.procs);
            const valorContratado = Object.values(precos).reduce((a, b) => a + b, 0) * 0; // Ser√° calculado por servi√ßo
            
            let html = `
                <div class="mes-container">
                    <div class="mes-titulo">${d.nome}</div>
                    
                    <div class="resumo-geral">
                        <div class="card-resumo">
                            <div class="card-label">Valor Contratado (M√™s)</div>
                            <div class="card-valor">${d.contratado}</div>
                        </div>
                        <div class="card-resumo">
                            <div class="card-label">Valor Gasto (M√™s)</div>
                            <div class="card-valor">${d.consumido}</div>
                        </div>
                        <div class="card-resumo">
                            <div class="card-label">Saldo</div>
                            <div class="card-valor" style="color: ${d.saldo.includes('-') ? '#ff6b6b' : '#51cf66'}">${d.saldo}</div>
                        </div>
                    </div>
                    
                    <div class="servicos-table">
                        <div class="table-titulo">üìä AN√ÅLISE POR SERVI√áO</div>
                        <table>
                            <thead>
                                <tr>
                                    <th>Servi√ßo</th>
                                    <th class="numero">Contratado</th>
                                    <th class="numero">Utilizado</th>
                                    <th class="numero">% Utiliza√ß√£o</th>
                                    <th class="numero">Valor Unit√°rio</th>
                                    <th class="numero">Valor Gasto</th>
                                    <th>Progresso</th>
                                </tr>
                            </thead>
                            <tbody>
            `;
            
            for (const [proc, qtd] of d.procs) {
                const contratado = contratos[proc] || 0;
                const preco = precos[proc] || 0;
                const percentual = contratado > 0 ? (qtd / contratado * 100).toFixed(1) : 0;
                const valorGastoProcedimento = preco * qtd;
                const status = qtd > contratado ? '‚ö†Ô∏è ACIMA' : qtd === contratado ? '‚úÖ NO LIMITE' : '‚úì OK';
                
                html += `
                    <tr>
                        <td>${proc}</td>
                        <td class="numero">${contratado}</td>
                        <td class="numero"><strong>${qtd}</strong></td>
                        <td class="numero">${percentual}% ${status}</td>
                        <td class="numero">${formatarMoeda(preco)}</td>
                        <td class="numero">${formatarMoeda(valorGastoProcedimento)}</td>
                        <td>
                            <div class="barra-progresso">
                                <div class="barra">
                                    <div class="barra-preenchida" style="width: ${Math.min(percentual, 100)}%"></div>
                                </div>
                                <span class="percentual">${percentual}%</span>
                            </div>
                        </td>
                    </tr>
                `;
            }
            
            html += `
                            </tbody>
                        </table>
                    </div>
                </div>
            `;
            
            document.getElementById('conteudoMes').innerHTML = html;
        }

        renderizarMesSeletor();
        renderizarMes('JAN');
    </script>
</body>
</html>